{% extends 'pages/base.html' %}
{% load static %}

{% block content %}
<style>
  /* Container */
  .requests-container {
      max-width: 1000px;
      margin: 40px auto;
      padding: 20px;
      background-color: #ffffff; /* white background */
      border: 2px solid green; /* green border */
      border-radius: 10px;
      box-shadow: 0 4px 6px black;
  }

  /* Title */
  .requests-container h2 {
      color:black;
      text-align: center;
      margin-bottom: 30px;
      font-weight: bold;
  }

  /* Search form */
  .requests-container .form-control {
      border: 2px solid green;
      border-radius: 5px;
  }

  .requests-container .btn-search {
      background-color: green;
      color: #ffffff;
      border: 1px solid green;
      font-weight: bold;
      transition: background-color 0.3s;
  }

  .requests-container .btn-search:hover {
      background-color: black;
  }

  /* Table */
  .requests-container table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
  }

  .requests-container table th,
  .requests-container table td {
      border: 1px solid green;
      padding: 10px;
      text-align: center;
  }

  .requests-container table th {
      background-color: green;
      color: #ffffff;
  }

  .requests-container table tr:nth-child(even) {
      background-color: #f4f4f4;
  }

  .requests-container .btn-message {
      background-color: white;
      color: green;
      border: 1px solid green;
      font-weight: bold;
      padding: 5px 10px;
      transition: background-color 0.3s;
  }

  .requests-container .btn-message:hover {
      background-color:black;
      color: #ffffff;
  }
</style>

<div class="requests-container">
    <h2>Chick Requests</h2>

    <!-- Search form -->
    <form method="get" class="mb-4 d-flex">
        <input type="text" name="q" class="form-control me-2" 
               placeholder="Search by your name" value="{{ query|default:'' }}">
        <button class="btn btn-search" type="submit">Search</button>
    </form>

    <!-- Requests table -->
    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>Farmer</th>
                <th>Sales Agent</th>
                <th>Chick Type</th>
                <th>Quantity</th>
                <th>Status</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            {% for req in chick_requests %}
            <tr>
                <td>{{ req.id }}</td>
                <td>{{ req.farmer_name.farmer_name|default:"N/A" }}</td>
                <td>{{ req.sales_agent.username|default:"N/A" }}</td>
                <td>{{ req.chick_type.name|default:"N/A" }}</td>
                <td>{{ req.chick_quantity|default:"N/A" }}</td>
                <td>{{ req.chick_status|default:"Pending" }}</td>
                <td>
                    {% if req.sales_agent %}
                    <a href="{% url 'contact_sales' %}?agent={{ req.sales_agent.id }}" 
                       class="btn btn-message">Message Sales</a>
                    {% else %}
                    N/A
                    {% endif %}
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="7" class="text-center">No requests found.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
